---
title: "Encuesta 2024"
author: "C谩tedra de Estad铆stica II - FCS - UNC"
date: "`r Sys.Date()`"
output: html_document
---

## Cargamos la base de datos

Para descargar la base de datos de la encuesta, utilizaremos la funci贸n googlesheets4(). Esta funci贸n permite conectarse directamente a una hoja de c谩lculo en Google y bajarla directamente al entorno de trabajo en R. Dentro de esta funci贸n se debe agregar como argumento el link a la hoja de c谩lculo correspondiente, en este caso es (s贸lo podr谩n acceder con su cuenta UNC):

https://docs.google.com/spreadsheets/d/1FW4EtmIWLB5bo0mXUDiOGJeI9g6uCTxEM00clT2V9ug/edit?usp=sharing

Una vez que ejecuten las siguientes l铆neas, se abrir谩 el navegador web. All铆 deber谩n loguearse con su cuenta de gmail "mi.unc.edu.ar" y luego retornar al entorno de R.

```{r, warning=FALSE, message=FALSE}
# install.packages("googlesheets4")
library(googlesheets4)
datos <- read_sheet('https://docs.google.com/spreadsheets/d/1FW4EtmIWLB5bo0mXUDiOGJeI9g6uCTxEM00clT2V9ug/edit?usp=sharing')
```

## Analizamos algunos datos b谩sicos

En primer lugar, exploramos cu谩les son las variables (cu谩les son las columnas) de nuestra base de datos.

```{r, warning=FALSE, message=FALSE}
names(datos)
```

驴Cu谩ntas encuestas hemos realizado? Si bien podemos verlo directamente en el panel "environment" de Rstudio (arriba a la derecha), la funci贸n nrow() nos permite conocer la cantidad de filas que tiene una tabla. Por lo tanto: 

```{r, warning=FALSE, message=FALSE}
nrow(datos)
```
Como vemos, hasta el momento nuestra encuesta ha recibido  `r nrow(datos)` respuestas.

Veamos un poco m谩s de cerca a la variable "edad", que hace referencia a la edad de la persona encuestada. En primer lugar, nos interesa saber con qu茅 tipo de datos estamos tratanto (se trata de una variable num茅rica? categ贸rica?)

```{r, warning=FALSE, message=FALSE}
class(datos$edad)
```
Como vemos, es una variable num茅rica. Por lo tanto, podemos calcular algunas medidas de tendencia central para analizar su distribuci贸n. La funci贸n summary() nos permite conocer cu谩les son los cuartiles y la media de esta variable.

```{r, warning=FALSE, message=FALSE}
summary(datos$edad)
```

Con la funci贸n sd() podemos conocer cu谩l es la desviaci贸n est谩ndar de esta variable.

```{r, warning=FALSE, message=FALSE}
sd(datos$edad)
```

Si queremos calcular el coeficiente de variaci贸n, tambi茅n podemos hacerlo, pero debemos calcularlo. Como sabemos, esta medida de dispersi贸n se calcula haciendo el cociente entre la desviaci贸n est谩ndar y la media, entonces:

```{r, warning=FALSE, message=FALSE}
sd(datos$edad) / mean(datos$edad)
```

Tambi茅n podemos visualizar un histograma de la distribuci贸n de esta variable haciendo:

```{r, warning=FALSE, message=FALSE}
hist(datos$edad)
```

Veamos ahora un poco m谩s de cerca a la variable que captura la identidad de g茅nero de las personas encuestadas. Qu茅 tipo de variable es? Se pueden calcular medidas de posici贸n y de dispersi贸n sobre esta variable?

```{r, warning=FALSE, message=FALSE}
class(datos$genero)
```
Como vemos, se trata de una variable categ贸rica. Para describirla, podemos utilizar la funci贸n table(), que informa la cantidad de casos que contiene cada categor铆a (es decir, la frecuencia absoluta):

```{r, warning=FALSE, message=FALSE}
table(datos$genero)
```

Si quisieramos ver las frecuencias relativas en vez de las frecuencias absolutas, "envolvemos" a la funci贸n table() utilizada anteriormente, con la funci贸n prop.table(), de la siguiente manera:

```{r, warning=FALSE, message=FALSE}
prop.table(table(datos$genero))
```
La tabla original de frecuencuas absolutas es muy r煤stica. Para hacerla visualmente m谩s agradable, podemos hacer uso de la funci贸n kable(). Nuevamente, si "envolvemos" a la funci贸n table() original con la funci贸n kable(), tenemos lo siguiente:

```{r, warning=FALSE, message=FALSE}
# install.packages("kableExtra")
library(kableExtra)
kable(table(datos$genero))
```

Como vemos, la nombre de la primera columna es "Var1", y eso queda poco prolijo. Si queremos cambiar el nombre de esta columna, dentro de la funci贸n kable() utilizamos el argumento "col.names" de la siguiente manera:

```{r, warning=FALSE, message=FALSE}
kable(table(datos$genero), col.names = c("G茅nero", "Frecuencia"))
```

### Usando "pipes"...

Una manera diferente de hacer la misma tabla es utilizando "pipes". Como se puede ver en el c贸digo anterior, hay dos funciones anidadas. Es decir, la funci贸n kable() tiene como argumento a otra funci贸n, table(). Hay una funci贸n dentro de otra. Cuando enfrentamos este tipo de fen贸menos que requieren una funci贸n dentro de otra, puede ser conveniente (o al menos m谩s ordenado) hacer uso de los pipes (%>%). Este artificio permite expresar las dependencias entre funciones de manera secuencial sin generar l铆neas de c贸digo tan extensas y plagadas de par茅ntesis. Entonces, en este caso, se expresa primero la funci贸n table(), luego el "pipe" (cuyo atajo en el teclado es ctrl+shit+m) y luego la funci贸n kable() con sus correspondientes arguementos (col.names):

```{r, warning=FALSE, message=FALSE}
# install.packages("tidyverse")
library(tidyverse)
table(datos$genero) %>% kable(col.names = c("G茅nero", "Frecuencia"))
```

>  *驴Pueden replicar estas tablas para las variables que indican el voto de las personas encuestadas en las elecciones generales y en el balotaje?*

<br></br>

## Imagen de figuras pol铆ticas


### Javier Milei

En primer lugar, observamos que la variable "imagen_milei" no es num茅rica, dado que en la lista de opciones para responder hab铆an palabras como "no s茅" y "no lo conozco". Por lo tanto, para calcular una medida n煤merica de tendencia central como la media o la mediana, necesitamos, primero, convertirla en una variable num茅rica; esto se logra mediante la funci贸n "as.numeric". Luego de esto ya estamos en condiciones de analizar su distribuci贸n:

```{r, warning=FALSE, message=FALSE}
datos$imagen_milei = as.numeric(datos$imagen_milei)
summary(datos$imagen_milei)
hist(datos$imagen_milei)
```

### Juan Grabois

El histograma anterior ten铆a algunas cuestiones de formato que ser铆a conveniente corregir. El t铆tulo indicaba "Histogram of datos$imagen_milei". Si quisieramos expresarlo en espa帽ol, y sin las expresiones de c贸digo como el s铆mbolo \$, debemos hacer uso del argumento "main" en la funci贸n "hist()".

```{r, warning=FALSE, message=FALSE}
datos$imagen_grabois = as.numeric(datos$imagen_grabois)
summary(datos$imagen_grabois)
hist(datos$imagen_grabois, main = "Histograma de la imagen del candidato")
```

### Patricia Bullrich

Si bien en el histograma anterior corregimos el t铆tulo del gr谩fico, a煤n quedan expresiones a corregir en los nombres de los ejes. Si deseamos reemplazar el t铆tulo del eje vertical de "Frecuency" a "Frecuencia", hacemos uso del argumento "ylab" de la funci贸n hist(). De igual manera, si queremos modificar el nombre del eje horizontal, hacemos uso del argumento "xlab" de la funci贸n hist(). Finalmente, si deseamos modificar el color de las barras, por ejemplo, hacemos uso del argumento "col" en la funci贸n hist().

```{r, warning=FALSE, message=FALSE}
datos$imagen_bullrich = as.numeric(datos$imagen_bullrich)
summary(datos$imagen_bullrich)
hist(datos$imagen_bullrich, main = "Histograma de la imagen de la candidata", ylab =  "Frecuencia", xlab = "Puntaje", col = "lightblue")
```

>  *驴Pueden calcular la imagen para el resto de las figuras pol铆ticas?*

>  *驴Cu谩l es la figura con mejor imagen en C贸rdoba? 驴Y la peor?*

<br></br>
<br></br>

## An谩lisis seg煤n diferentes grupos

Veamos la imagen de Javier Milei seg煤n la identidad de g茅nero de las personas encuestadas. Comencemos por analizar s贸lo aquellas personas cuya identidad de g茅nero sea "mujer".

```{r, warning=FALSE, message=FALSE}
mujeres = filter(datos, datos$genero == "mujer")
```

Utilizando la funci贸n filter() hemos creado un nuevo objeto consistente en un dataframe con `r nrow(mujeres)` observaciones y `r ncol(mujeres)`. Como es esperable, entonces, el nuevo objeto tiene la misma estructura que la base de datos original, s贸lo que menos filas, dado que est谩 compuesto s贸lo por aquellas personas cuya identidad de g茅nero es "mujer".

Ahora calculamos la media de la imagen: 

```{r, warning=FALSE, message=FALSE}
mean(mujeres$imagen_milei, na.rm = TRUE)
```
<br></br>

#### Entre las personas cuya identidad de g茅nero es "mujer", 驴la imagen de Javier Milei es m谩s alta o m谩s baja que la observada en la poblaci贸n general?

>  *驴Y si replicamos el an谩lisis para cada una de las categor铆as de la variable "genero"?*

>  *驴Qu茅 sucede respecto a la imagen del resto de las figuras pol铆ticas que consideramos en la encuesta? 驴Hay diferencias en la valoraci贸n entre diferentes indentidades de g茅nero?*

<br></br>

Veamos ahora la imagen de Juan Grabois entre las personas menores de 30 a帽os. Para ello, replicamos el an谩lisis anterior, pero creamos una nueva base de datos "filtrando" por edad. Entonces:

```{r, warning=FALSE, message=FALSE}
menores_30 = filter(datos, datos$edad < 30)
mean(menores_30$imagen_grabois, na.rm = TRUE)
```

Ahora comparemos con el escenario para las personas de m谩s de 50 a帽os:

```{r, warning=FALSE, message=FALSE}
mayores_50 = filter(datos, datos$edad > 50)
mean(mayores_50$imagen_grabois, na.rm = TRUE)
```

<br></br> 

>  *驴Qu茅 sucede en el caso de personas cuya edad est谩 comprendida entre los 30 y los 50 a帽os?*

>  *驴Qu茅 observamos para el resto de las figuras pol铆ticas?*


<br></br> 

Analicemos ahora qu茅 puntaje le asignan las personas encuestadas al problema de la inflaci贸n, considerando s贸lo aquellas cuya identidad de g茅nero es "var贸n" y tienen menos de 30 a帽os. Para ello, debemos agregar esta condici贸n compuesta a la funci贸n filter(). Para unir estas dos condiciones haremos uso del operador l贸gico *&*, entendido como "y": varones "y" menores de 30. 

```{r, warning=FALSE, message=FALSE}
grupo = filter(datos, datos$edad < 30 & datos$genero == "var贸n")
mean(grupo$problemas_inflacion, na.rm = TRUE)
```
Veamos ahora que sucede si consideramos s贸lo aquellas personas cuya identidad de g茅nero es "var贸n", pero tienen m谩s de 60 a帽os.

```{r, warning=FALSE, message=FALSE}
grupo = filter(datos, datos$edad > 60 & datos$genero == "var贸n")
mean(grupo$problemas_inflacion, na.rm = TRUE)
```
<br></br>

>  *驴Podemos afirmar que existen diferencias en la valoraci贸n del problema entre estos dos grupos?  Para responder a la pregunta anterior, debemos hacer uso de los <b>intervalos de confianza</b>*


<br></br>
<br></br>